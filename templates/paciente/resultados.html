<!DOCTYPE html>
<html lang="es">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Resultado y Recomendaciones</title>
Â  Â  
Â  Â  {# Asumo que tienes un base.html o CSS bÃ¡sico para dar estilo #}
Â  Â  {# Si estÃ¡s usando un base_simple.html que hereda de base.html, Ãºsalo aquÃ­ #}
Â  Â  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

Â  Â  <style>
Â  Â  Â  Â  /* Estilos especÃ­ficos para la pÃ¡gina de resultados */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  background-color: #f8f9fa; /* Fondo claro */
Â  Â  Â  Â  }
Â  Â  Â  Â  .resultado-card {
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  padding: 40px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  background-color: white;
Â  Â  Â  Â  Â  Â  max-width: 500px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  .resultado-display {
Â  Â  Â  Â  Â  Â  font-size: 3rem;
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 25px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .positivo .resultado-display {
Â  Â  Â  Â  Â  Â  background-color: #D32F2F; /* Rojo */
Â  Â  Â  Â  }
Â  Â  Â  Â  .negativo .resultado-display {
Â  Â  Â  Â  Â  Â  background-color: #388E3C; /* Verde */
Â  Â  Â  Â  }
Â  Â  Â  Â  .alert-recomendacion {
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .positivo .alert-recomendacion {
Â  Â  Â  Â  Â  Â  border: 2px solid #D32F2F;
Â  Â  Â  Â  Â  Â  background-color: #F8D7DA; /* Rosa claro */
Â  Â  Â  Â  Â  Â  color: #721C24;
Â  Â  Â  Â  }
Â  Â  Â  Â  .negativo .alert-recomendacion {
Â  Â  Â  Â  Â  Â  border: 2px solid #388E3C;
Â  Â  Â  Â  Â  Â  background-color: #D4EDDA; /* Verde claro */
Â  Â  Â  Â  Â  Â  color: #155724;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-finalizar {
Â  Â  Â  Â  Â  Â  background-color: #6C757D;
Â  Â  Â  Â  Â  Â  border-color: #6C757D;
Â  Â  Â  Â  Â  Â  color: white; /* Asegurar texto blanco */
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px 0;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-finalizar:hover {
Â  Â  Â  Â  Â  Â  background-color: #5A6268;
Â  Â  Â  Â  Â  Â  border-color: #5A6268;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Estilos bÃ¡sicos para simular Bootstrap/Flexbox sin importar la librerÃ­a completa */
Â  Â  Â  Â  .container { width: 100%; padding: 0 15px; }
Â  Â  Â  Â  .text-center { text-align: center; }
Â  Â  Â  Â  .mb-4 { margin-bottom: 1.5rem; }
Â  Â  Â  Â  .mt-4 { margin-top: 1.5rem; }
Â  Â  Â  Â  .mb-3 { margin-bottom: 1rem; }
Â  Â  Â  Â  .mt-3 { margin-top: 1rem; }
Â  Â  Â  Â  .text-start { text-align: left; }
Â  Â  Â  Â  .fw-bold { font-weight: bold; }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="resultado-card text-center {{ clase_resultado }}">
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <h1 class="mb-4">Resultado de la Autoprueba VIH</h1>

Â  Â  Â  Â  Â  Â  <div class="resultado-display">
Â  Â  Â  Â  Â  Â  Â  Â  {{ resultado }}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <h3 class="mt-4 mb-3">Recomendaciones:</h3>

Â  Â  Â  Â  Â  Â  <div class="alert-recomendacion text-start">
Â  Â  Â  Â  Â  Â  Â  Â  <p>{{ recomendacion }}</p>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  {% if resultado == 'Positivo' %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="fw-bold mt-3">ðŸ”´ Importante: Este resultado debe ser confirmado por un profesional de la salud.</p>
Â  Â  Â  Â  Â  Â  Â  Â  {% else %}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="fw-bold mt-3">âœ… Â¡Excelente! MantÃ©n tus prÃ¡cticas de prevenciÃ³n.</p>
Â  Â  Â  Â  Â  Â  Â  Â  {% endif %}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <hr class="mt-5 mb-3">

Â  Â  Â  Â  Â  Â  {# LLAMADA A LA FUNCIÃ“N REFORZADA DE CIERRE #}
Â  Â  Â  Â  Â  Â  <button onclick="finalizarProceso();" class="btn btn-finalizar">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-sign-out-alt"></i> Finalizar Proceso y Cerrar Ventana
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  Â  
Â  Â  <script>
Â  Â  Â  Â  function finalizarProceso() {
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // 1. Intento de Cierre Directo (solo funciona si la ventana fue abierta por script)
Â  Â  Â  Â  Â  Â  window.close();

Â  Â  Â  Â  Â  Â  // 2. Si el cierre es bloqueado, redirigimos a una pÃ¡gina final y limpiamos el historial.
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  // Intentar reemplazar el estado del historial para evitar el botÃ³n 'atrÃ¡s'
Â  Â  Â  Â  Â  Â  Â  Â  if (window.history.replaceState) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Nota: Asume que tienes la ruta 'paciente_bp.fin_proceso' definida.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Usamos la URL completa del Flask para asegurar la navegaciÃ³n.
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.history.replaceState(null, null, '{{ url_for("paciente_bp.fin_proceso") }}');
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Redirige a la pÃ¡gina final
Â  Â  Â  Â  Â  Â  Â  Â  window.location.replace('{{ url_for("paciente_bp.fin_proceso") }}');

Â  Â  Â  Â  Â  Â  Â  Â  // Si todo lo anterior falla (navegador muy restrictivo), muestra un mensaje
Â  Â  Â  Â  Â  Â  Â  Â  document.body.innerHTML = '<div style="text-align:center; padding: 50px;"><h1>Proceso Finalizado.</h1><p>Gracias por usar el sistema. Puede cerrar la ventana ahora.</p></div>';

Â  Â  Â  Â  Â  Â  }, 100); // PequeÃ±o retraso para dar tiempo a window.close()
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>