{# templates/paciente/datos_personales.html #}

{# CRÍTICO: Solo se extiende UNA plantilla base #}
{% extends 'base_paciente.html' %} 

{% block title %}Datos Personales{% endblock %}

{% block patient_content %}

    <h2>Ingresa tus Datos Personales</h2>
    <p>Por favor, completa la siguiente información. Los campos precargados no pueden modificarse.</p>

    {# CRÍTICO: La acción del formulario debe apuntar a la función que guarda los datos. #}
    <form action="{{ url_for('paciente_bp.guardar_datos_personales') }}" method="POST" style="margin-top: 30px;">
        
        {# Los datos de nombre, apellido, edad y sexo ya vienen de la BD y son solo de lectura #}
        <div class="form-group">
            <label for="nombre" class="form-label">Nombre:</label>
            {# Se usa la variable 'datos' enviada desde control_flujo_paciente #}
            <input type="text" id="nombre" name="nombre" class="form-control" 
                   value="{{ datos.nombre }}" disabled>
        </div>

        <div class="form-group">
            <label for="apellido_paterno" class="form-label">Apellido Paterno:</label>
            <input type="text" id="apellido_paterno" name="apellido_paterno" class="form-control" 
                   value="{{ datos.apellido_paterno }}" disabled>
        </div>

        <div class="form-group">
            <label for="apellido_materno" class="form-label">Apellido Materno:</label>
            <input type="text" id="apellido_materno" name="apellido_materno" class="form-control" 
                   value="{{ datos.apellido_materno }}" disabled>
        </div>
        
        <div class="form-group">
            <label for="edad" class="form-label">Edad:</label>
            <input type="number" id="edad" name="edad" class="form-control" 
                   value="{{ datos.edad }}" disabled>
        </div>
        
        <div class="form-group">
            <label for="sexo" class="form-label">Sexo:</label>
            <input type="text" id="sexo" name="sexo" class="form-control" 
                   value="{{ datos.sexo }}" disabled>
        </div>

        <hr>
        
        {# Campos que sí debe completar/actualizar el paciente #}
        
        <div class="form-group">
            <label for="telefono" class="form-label">Teléfono (Opcional):</label>
            <input type="tel" id="telefono" name="telefono" class="form-control" 
                   placeholder="Número de contacto" value="{{ datos.telefono or '' }}">
        </div>

        <div class="form-group">
            <label for="ocupacion" class="form-label">Ocupación (Opcional):</label>
            <input type="text" id="ocupacion" name="ocupacion" class="form-control" 
                   placeholder="Tu Ocupación" value="{{ datos.ocupacion or '' }}">
        </div>

        <div class="form-group">
            <label for="localidad" class="form-label">Localidad/Colonia (Opcional):</label>
            <input type="text" id="localidad" name="localidad" class="form-control" 
                   placeholder="Tu Localidad" value="{{ datos.localidad or '' }}">
        </div>

        <button type="submit" class="btn btn-primary btn-lg" style="margin-top: 20px;">
            Guardar y Ver Resultados
        </button>
    </form>

{% endblock %}